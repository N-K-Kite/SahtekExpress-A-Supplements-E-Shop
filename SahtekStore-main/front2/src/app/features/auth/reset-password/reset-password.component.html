<div class="auth-container">
    <div class="auth-card glass-morphism">
        <div class="auth-header">
            <div class="brand-logo mb-4">
                <i class="bi bi-lightning-charge-fill"></i>
                <span>Sahtek <small>Nutrition</small></span>
            </div>

            <h2 class="auth-title">{{ success ? 'Succès !' : 'Nouveau mot de passe' }}</h2>
            <p class="auth-subtitle">
                {{ success ? 'Votre mot de passe a été réinitialisé avec succès. Redirection...' : 'Choisissez votre
                nouveau mot de passe sécurisé.' }}
            </p>
        </div>

        <div class="auth-body">
            <form *ngIf="!success" (ngSubmit)="onSubmit()" #resetForm="ngForm">
                <div class="form-floating mb-3">
                    <input type="password" class="form-control" id="password" name="password"
                        placeholder="Nouveau mot de passe" [(ngModel)]="password" required minlength="6" #pwd="ngModel">
                    <label for="password">Nouveau mot de passe</label>
                    <div class="invalid-feedback d-block" *ngIf="pwd.invalid && (pwd.dirty || pwd.touched)">
                        Minimum 6 caractères.
                    </div>
                </div>

                <div class="form-floating mb-4">
                    <input type="password" class="form-control" id="confirmPassword" name="confirmPassword"
                        placeholder="Confirmer le mot de passe" [(ngModel)]="confirmPassword" required>
                    <label for="confirmPassword">Confirmer le mot de passe</label>
                </div>

                <div *ngIf="errorMessage" class="alert alert-danger-premium mb-4">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                    {{ errorMessage }}
                </div>

                <button type="submit" class="btn-premium w-100" [disabled]="resetForm.invalid || loading || !token">
                    <span *ngIf="!loading">Réinitialiser</span>
                    <span *ngIf="loading" class="spinner-border spinner-border-sm" role="status"></span>
                </button>
            </form>

            <div *ngIf="success" class="text-center">
                <div class="success-icon mb-4">
                    <i class="bi bi-check-circle-fill"></i>
                </div>
                <a routerLink="/login" class="btn-premium d-inline-block text-decoration-none">
                    Se connecter maintenant
                </a>
            </div>
        </div>
    </div>
</div>